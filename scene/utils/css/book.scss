:root {
    --bookSize:clamp(200px, 75vh, 1000px);
    --bookBorder:rgb(50, 50, 50);
    --bookPage:whitesmoke;    
    --colorMain1:rgb(17, 126, 181);
    --colorMain2:rgb(20, 172, 249);
}

// @media screen and (max-width: 800px) {
//     :root {
//         --bookSize:200px!important;
//     }
// }

#PORTFOLIO.anim {
    transform:translateZ(-500px);
}
#PORTFOLIO {
    transform:translateZ(-500px);
}

#book {
    transform-style:preserve-3d ;
    height: 80vh;
    width: 56vw;
    display: grid;
    place-content: center;
}

#readBook {
    display: none;

    &:checked {
        background-image:url('../../../divers/img/inputBook2.png');
        background-size:contain;
        background-repeat: no-repeat;
    }

    &:checked ~ #livre .blocLivre.droite {
        animation: openBookRight 2s linear forwards;
    }

    &:checked ~ #livre .blocLivre.gauche {
        animation: openBookLeft 2s linear forwards;
    }
}

#livre {
    position: absolute;
    transform-style: preserve-3d;
    align-self: center;
    justify-self: center;
    display:grid;
    grid-template-columns:calc(70 / 99 * var(--bookSize)) 30px calc(70 / 99 * var(--bookSize));
    height:var(--bookSize);
    width:calc(140 / 99 * var(--bookSize) + 30px);
    transform: rotateX(38deg) rotate(-6deg);
    cursor: pointer;

    &:hover .page.droite,
    &:hover .fpage:nth-of-type(6)::after,
    &:hover .fpage:nth-of-type(10)::before,
    &:hover .sliceR .sliceR {
        animation-play-state: paused!important;
    }
}

.blocLivre {
    position: absolute;
    transform-style: preserve-3d;
    
    height:var(--bookSize);
    width:calc(70 / 99 * var(--bookSize));
    height:var(--bookSize);

    box-shadow:
    0 0 30px 10px #fff,
    0 0 50px 20px var(--colorMain2),
    0 0 70px 30px var(--colorMain1);

    .fpage {
        position: absolute;
        transform-style:preserve-3d;
        transform-origin:inherit ;
        height: var(--bookSize);
        width:calc(70 / 99 * var(--bookSize));
        background-color: var(--bookPage);
        box-sizing: border-box;
        border: 1px solid var(--bookBorder);

        &::before {
            content:'';
            position: absolute;
            transform-origin: inherit;

            top:0;
            left:0;
            height: var(--bookSize);
            width:calc(70 / 99 * var(--bookSize));
            box-sizing: border-box;
            border: 1px solid var(--bookBorder);
            background-color: var(--bookPage);
        }

        &::after {
            content:'';
            position: absolute;
            transform-origin: inherit;

            top:0;
            left:0;
            height: var(--bookSize);
            width:calc(70 / 99 * var(--bookSize));
            box-sizing: border-box;
            border: 1px solid var(--bookBorder);
            background-color: var(--bookPage);
        }
    }

    &.gauche {
        grid-column: 1;
        transform-origin: right;
        transform: rotateY(88deg);

        @for $i from 0 to 4 {
            .fpage.gauche:nth-of-type(#{$i + 1}) {
                transform: translateZ(calc(3px * $i + 2px)) rotateY(calc(.4deg + (.6deg * $i)));
                &::before {
                    transform: translateZ(-2px) rotateY(-.4deg);
                }
                &::after {
                    transform: translateZ(2px) rotateY(.4deg);
                }
            }
        }

        .fpage.gauche:nth-of-type(1)::before {
            background-color: var(--bookBorder);
        }

        .fpage.gauche:nth-of-type(4)::after {
            background-image: url('../../../divers/img/2.jpg');
            background-size: cover;
        }

        // .fpage.gauche:nth-of-type(4) {
        //     &::after {
        //         background:url('../../../divers/img/imgLWait1.jpg');
        //         background-size:cover;
        //         background-repeat: no-repeat;    
        //     }
        // }
    }

    &.droite {
        grid-column: 3;
        transform-origin: left;
        transform: rotateY(-88deg);

        @for $i from 0 to 4 {
            .fpage.droite:nth-of-type(#{$i + 1}) {
                transform: translateZ(calc(3px * $i + 2px)) rotateY(calc(-.4deg - (.6deg * $i)));
                &::before {
                    transform: translateZ(-2px) rotateY(.4deg);
                }
                &::after {
                    transform: translateZ(2px) rotateY(-.4deg);
                }
            }
        }

        .fpage.droite:nth-of-type(1)::before {
            background-color: var(--bookBorder);
        }

        .fpage.droite:nth-of-type(4)::after {
            background-image: url('../../../divers/img/1.jpg');
            background-size: cover;
        }
    }
}

@keyframes openBookLeft {
    from {
        transform: rotateY(88deg);
    }

    to {
        transform: rotateY(0deg);
    }
}

@keyframes openBookRight {
    from {
        transform: rotateY(-88deg);
    }

    to {
        transform: rotateY(-0deg);
    }
}

.page.gauche, .page.droite {
    visibility: hidden;
    position: absolute;
    top:0;
    left:0;
    height: var(--bookSize);
    width:calc(70 / 99 * var(--bookSize) - 3px);
    transform-style: preserve-3d;
}

.sliceL, .sliceR {
    //visibility: hidden;
    position: absolute;
    transform-style: preserve-3d;
    backface-visibility: hidden;
    height: var(--bookSize);
    width: calc(10 / 99 * var(--bookSize));
    top:0;
    background-size:calc(70 / 99 * var(--bookSize)) var(--bookSize);
}

.page.gauche {
    transform-origin: right;
    transform: translateZ(6px) rotateY(1deg);
    cursor: pointer;
}

.sliceL {
    background:url('../../../divers/img/imgL.jpg');
    background-position: calc(80 / 99 * var(--bookSize)) center;
    background-size:calc(70 / 99 * var(--bookSize)) var(--bookSize);
    right:-0.5px;

    .sliceL {
        right:calc(10 / 99 * var(--bookSize) - .5px);
        background-position: calc(20 / 99 * var(--bookSize)) center;
        animation: waitingLeftSlice1 2s linear infinite forwards;
        transform-style: preserve-3d;
        .sliceL {
            right:calc(10 / 99 * var(--bookSize) - .5px);
            background-position: calc(30 / 99 * var(--bookSize)) center;
            animation: waitingLeftSlice2 2s linear infinite forwards;
            transform-style: preserve-3d;
            .sliceL {
                right:calc(10 / 99 * var(--bookSize) - .5px);
                background-position: calc(40 / 99 * var(--bookSize)) center;
                transform-style: preserve-3d;
                .sliceL {
                    right:calc(10 / 99 * var(--bookSize) - .5px);
                    background-position: calc(50 / 99 * var(--bookSize)) center;
                    transform-style: preserve-3d;
                    .sliceL {
                        right:calc(10 / 99 * var(--bookSize) - .5px);
                        background-position: calc(60 / 99 * var(--bookSize)) center;                
                        transform-style: preserve-3d;
                        .sliceL {
                            right:calc(10 / 99 * var(--bookSize) - .5px);
                            background-position: calc(70 / 99 * var(--bookSize)) center;
                            transform-style: preserve-3d;
                        }
                    }
                }
            }
        }
    }
}

.sliceL {
    transform-origin: right;
    //transform: rotateY(0deg);
    .sliceL {
        transform-origin: right;
        //transform: rotateY(0deg);
        .sliceL {
            transform-origin: right;
            //transform: rotateY(0deg);
            .sliceL {
                transform-origin: right;
                //transform: rotateY(0deg);
                .sliceL {
                    transform-origin: right;
                    //transform: rotateY(0deg);
                    .sliceL {
                        transform-origin: right;
                        //transform: rotateY(0deg);
                        .sliceL {
                            transform-origin: right;
                            //transform: rotateY(0deg);
                        }
                    }
                }
            }
        }
    }
}

.page.droite {
    visibility: visible;
    transform-origin: left;
    transform: translateX(-10px) translateZ(6px) rotateY(-179deg);
    cursor: pointer;

    &:hover,
    &:hover ~ .fpage:nth-of-type(6)::after,
    &:hover ~ .fpage:nth-of-type(10)::before,
    &:hover .sliceR .sliceR  {
        animation-play-state: paused!important;
    }
}

@keyframes pageDroite {
    0% {
        transform: translateX(5px) translateZ(6px) rotateY(179deg);
        visibility: hidden;
    }
    1% {
        transform: translateX(5px) translateZ(6px) rotateY(179deg);
        visibility: visible;
    }

    98% {
        transform: translateX(0px) translateZ(5.5px) rotateY(1deg);
        visibility: visible;
    }
    99% {
        transform: translateX(0px) translateZ(6px) rotateY(1deg);
        visibility: hidden;
    }
    100% {
        transform: translateX(5px) translateZ(6px) rotateY(179deg);
        visibility: hidden;
    }
}

.sliceR {
    background:url('../../../divers/img/imgLWait1.jpg');
    background-size:calc(70 / 99 * var(--bookSize)) var(--bookSize);

    right:0px;
    background-position: calc(10 / 99 * var(--bookSize)) center;

    &::after {
        position: absolute;
        top:0;
        left:0;
        content:'';
        top:0;
        left:0;
        height: var(--bookSize);
        width: calc(10 / 99 * var(--bookSize));
        backface-visibility: hidden;
        transform-origin: center;
        background:url('../../../divers/img/imgRFront.jpg');
        background-size:calc(70 / 99 * var(--bookSize)) var(--bookSize);
        background-position:calc(70 / 99 * var(--bookSize)) center;
    }
    
    .sliceR {
        right:calc(10 / 99 * var(--bookSize) - .5px);
        background-position: calc(20 / 99 * var(--bookSize)) center;
        transform-style:preserve-3d;
        
        &::after {
            background-position: calc(60 / 99 * var(--bookSize)) center;
        }

        .sliceR {
            right:calc(10 / 99 * var(--bookSize) - .5px);
            background-position: calc(30 / 99 * var(--bookSize)) center;
            transform-style:preserve-3d;
            
            &::after {
                top:0;
                left:0;
                background-position: calc(50 / 99 * var(--bookSize)) center;
            }

            .sliceR {
                right:calc(10 / 99 * var(--bookSize) - .5px);
                background-position: calc(40 / 99 * var(--bookSize)) center;
                transform-style:preserve-3d;
                
                &::after {
                    top:0;
                    left:0;
                    background-position: calc(40 / 99 * var(--bookSize)) center;
                }

                .sliceR {
                    right:calc(10 / 99 * var(--bookSize) - .5px);
                    background-position: calc(50 / 99 * var(--bookSize)) center;
                    transform-style:preserve-3d;
                    
                    &::after {
                        top:0;
                        left:0;
                        background-position: calc(30 / 99 * var(--bookSize)) center;
                    }

                    .sliceR {
                        right:calc(10 / 99 * var(--bookSize) - .5px);
                        background-position: calc(60 / 99 * var(--bookSize)) center;                
                        transform-style:preserve-3d;
                        
                        &::after {
                            top:0;
                            left:0;
                            background-position: calc(20 / 99 * var(--bookSize)) center;
                        }

                        .sliceR {
                            right:calc(10 / 99 * var(--bookSize) - .5px);
                            background-position: calc(70 / 99 * var(--bookSize)) center;
                            transform-style:preserve-3d;
                            
                            &::after {
                                top:0;
                                left:0;
                                background-position: calc(10 / 99 * var(--bookSize)) center;
                            }
                        }
                    }
                }
            }
        }
    }
}

.sliceR {
    transform-style:preserve-3d;
    transform-origin: right;

    &::after {
        top:0;
        left:0;
        transform: rotateY(180deg);
    }
    .sliceR {
        transform-style:preserve-3d;
        .sliceR {
            transform-style:preserve-3d;
            .sliceR {
                transform-style:preserve-3d;
                .sliceR {
                    transform-style:preserve-3d;
                    .sliceR {
                        transform-style:preserve-3d;
                        .sliceR {
                            transform-style:preserve-3d;
                        }
                    }
                }
            }
        }
    }
}

@keyframes sliceR {
    0% {
        transform: rotateY(-1deg);
    }

    60% {
        transform: rotateY(10deg);
    }

    80% {
        transform: rotateY(14deg);
    }

    90% {
        transform: rotateY(13deg);
    }

    98% {
        transform: rotateY(0deg);

    }
    99% {
        transform: rotateY(-1deg);

    }
    100% {
        transform: rotateY(-1deg);
    }
}

@keyframes waitingLeft {
    0% {
        background:url('../../../../../divers/img/imgLWait1.jpg');
        background-size:cover;
        background-repeat: no-repeat;
    }
    20% {
        background:url('../../../divers/img/imgLWait1.jpg');
        background-size:cover;
        background-repeat: no-repeat;
        filter:blur(0px);
        opacity: 1;
    }
    29% {
        background:url('../../../divers/img/imgLWait1.jpg');
        background-size:cover;
        background-repeat: no-repeat;
        filter:blur(4px);
        opacity: .9;
    }
    31% {
        background:url('../../../divers/img/imgLWait2.jpg');
        background-size:cover;
        background-repeat: no-repeat;
        filter:blur(4px);
        opacity: .9;
    }
    40% {
        background:url('../../../divers/img/imgLWait2.jpg');
        background-size:cover;
        background-repeat: no-repeat;
        filter:blur(0px);
        opacity: 1;
    }
    97% {
        background:url('../../../divers/img/imgLWait2.jpg');
        background-size:cover;
        background-repeat: no-repeat;
    }
    98% {
        background:url('../../../divers/img/imgLWait1.jpg');
        background-size:cover;
        background-repeat: no-repeat;
    }
    100% {
        background:url('../../../divers/img/imgLWait1.jpg');
        background-size:cover;
        background-repeat: no-repeat;
    }
}

@keyframes waitingRight {
    0% {
        background:url('../../../divers/img/imgRWait2.jpg');
        background-size:cover;
        background-repeat: no-repeat;
    }

    2% {
        background:url('../../../divers/img/imgRWait1.jpg');
        background-size:cover;
        background-repeat: no-repeat;
    }

    70% {
        background:url('../../../divers/img/imgRWait1.jpg');
        background-size:cover;
        background-repeat: no-repeat;
        filter:blur(0px);
        opacity:1;
    }
    79% {
        background:url('../../../divers/img/imgRWait1.jpg');
        background-size:cover;
        background-repeat: no-repeat;
        filter:blur(4px);
        opacity:.9;
    }
    81% {
        background:url('../../../divers/img/imgRWait2.jpg');
        background-size:cover;
        background-repeat: no-repeat;
        filter:blur(4px);
        opacity:.9;
    }
    90% {
        background:url('../../../divers/img/imgRWait2.jpg');
        background-size:cover;
        background-repeat: no-repeat;
        filter:blur(0px);
        opacity:1;
    }
    100% {
        background:url('../../../divers/img/imgRWait2.jpg');
        background-size:cover;
        background-repeat: no-repeat;
    }
}